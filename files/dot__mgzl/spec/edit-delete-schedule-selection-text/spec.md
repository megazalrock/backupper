# 繰り返しスケジュール編集・削除時の選択肢テキスト改善 仕様書

## 概要
繰り返しスケジュールの編集・削除時に表示される選択肢テキストおよび確認モーダルの文言を、より分かりやすく具体的なものに修正する。ユーザーが操作の影響範囲を明確に理解できるよう、日付を含む具体的な表現に変更する。

## 目的
- **UX改善**: ユーザーが選択肢の意味を直感的に理解できるようにする
- **問い合わせ削減**: 操作の影響範囲が不明確であることによるサポートへの問い合わせや操作ミスを減らす
- **UI統一**: 他の機能との表現を統一し、一貫性のあるユーザー体験を提供する

## 用語定義
| 用語 | 定義 |
|------|------|
| 繰り返しスケジュール | 複数日にわたって繰り返される予定 |
| 個別編集 | 繰り返しスケジュールの中の特定の1日のみを編集する操作 |
| 全体編集 | 繰り返しスケジュールの全期間を一括で編集する操作 |
| 期間指定編集 | 繰り返しスケジュールの一部期間を指定して編集する操作 |
| 以降編集 | 現在閲覧中の日付以降の全ての予定を編集する操作 |
| 現在閲覧中の日付 | ユーザーがスケジュールモーダルを開いた時に表示されている予定の日付 |

## 機能要件

### FR-001: 日付フォーマット
- **説明**: 選択肢テキストに含まれる日付は統一されたフォーマットで表示する
- **フォーマット**: 「mm月dd日」（先頭0なし）
- **例**: 1月1日、12月31日
- **制約**:
  - 年の表示は常に省略する（年をまたぐ場合も省略）
  - 表示する日付は、ユーザーが現在閲覧中のスケジュールの日付とする
- **優先度**: 高

### FR-002: 編集時の選択肢テキスト変更
- **説明**: 繰り返しスケジュール詳細からの編集時に表示される4つの選択肢テキストを変更する
- **変更内容**:
  | 現在のテキスト | 修正後のテキスト |
  |---------------|----------------|
  | 繰り返しスケジュール全体を編集 | 全期間を編集 |
  | 個別にスケジュールを編集 | mm月dd日のみ編集 |
  | 期間指定して繰り返しスケジュールを編集 | 期間を指定して編集 |
  | 以降の繰り返しスケジュールを変更 | mm月dd日以降を編集 |
- **適用範囲**: ホワイトボード、カレンダー、手配表、案件詳細のスケジュールモーダル
- **優先度**: 高

### FR-003: 削除時の選択肢テキスト変更（スケジュール）
- **説明**: 繰り返しスケジュール詳細からの削除時に表示される4つの選択肢テキストを変更する
- **変更内容**:
  | 現在のテキスト | 修正後のテキスト |
  |---------------|----------------|
  | 繰り返しスケジュール全体を削除 | 全期間を削除 |
  | 個別にスケジュールを削除 | mm月dd日のみ削除 |
  | 期間指定して繰り返しスケジュールを削除 | 期間を指定して削除 |
  | 以降の繰り返しスケジュールを削除 | mm月dd日以降を削除 |
- **適用範囲**: ホワイトボード、カレンダー、手配表、案件詳細のスケジュールモーダル
- **優先度**: 高

### FR-004: 削除時の選択肢テキスト変更（自社職人・協力会社）
- **説明**: 自社職人や協力会社を担当から外す際の選択肢テキストを変更する
- **変更内容**:
  | 現在のテキスト | 修正後のテキスト |
  |---------------|----------------|
  | xxxをスケジュール全体の担当から外す | xxxを全期間の担当から外す |
  | xxxを個別にスケジュールの担当から外す | xxxをmm月dd日の担当から外す |
- **注記**: xxxは担当者名を表す動的な値
- **優先度**: 高

### FR-005: 削除時の選択肢テキスト変更（非消耗品）
- **説明**: 非消耗品を割当から外す際の選択肢テキストを変更する
- **変更内容**:
  | 現在のテキスト | 修正後のテキスト |
  |---------------|----------------|
  | xxxをスケジュール全体の割当から外す | xxxを全期間の割当から外す |
  | xxxを個別にスケジュールの割当から外す | xxxをmm月dd日の割当から外す |
- **注記**: xxxは非消耗品名を表す動的な値
- **優先度**: 高

### FR-006: 削除確認モーダル（全体削除）
- **説明**: スケジュール全体削除時の確認モーダルの文言を変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | タイトル | 本当に繰り返しスケジュール全体を削除しますか？ | 本当に削除しますか？ |
  | 本文 | スケジュール全体が削除されます。削除すると復元することができません。よろしいですか？ | スケジュール全体を削除します。削除すると復元できません。よろしいですか？ |
  | 注釈 | ※スケジュールを削除しても案件自体は残ります。 | （変更なし） |
- **優先度**: 高

### FR-007: 削除確認モーダル（個別削除）
- **説明**: スケジュール個別削除時の確認モーダルの文言を変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | タイトル | 本当に削除しますか？ | （変更なし） |
  | 本文 | このスケジュールが個別に削除されます。削除すると復元することができません。よろしいですか？ | yyyy年mm月dd日のスケジュールを削除します。削除すると復元できません。よろしいですか？ |
  | 注釈 | ※スケジュールを削除しても案件自体は残ります。 | （変更なし） |
- **特記事項**: 個別削除の本文には年（yyyy年）も含める
- **優先度**: 高

### FR-008: 削除確認モーダル（期間指定削除・以降削除）
- **説明**: 期間指定削除・以降削除時の確認モーダルの文言を変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | 本文 | 削除すると復元することができません。よろしいですか？ | 削除すると復元できません。よろしいですか？ |
- **優先度**: 中

### FR-009: 担当者削除確認モーダル（全体から解除）
- **説明**: 担当者をスケジュール全体から外す際の確認モーダルの文言を変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | タイトル | 田中 庄治さんをスケジュール全体の担当から外しますか？ | 田中 庄治さんを担当から外しますか？ |
  | 本文 | 田中 庄治さんを繰り返しスケジュール全体の担当から外します。よろしいですか？ | 田中 庄治さんをスケジュール全体の担当から外します。よろしいですか？ |
- **注記**: 「田中 庄治」は担当者名を表す動的な値
- **優先度**: 高

### FR-010: 担当者削除確認モーダル（個別に解除）
- **説明**: 担当者を個別に外す際の確認モーダル
- **変更内容**: なし（現状維持）
- **優先度**: -

### FR-011: 非消耗品削除確認モーダル（全体から解除）
- **説明**: 非消耗品をスケジュール全体から外す際の確認モーダルの文言を変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | タイトル | トラックをスケジュール全体の割当から外しますか？ | トラックを割当から外しますか？ |
  | 本文 | トラックを繰り返しスケジュール全体の割当から外します。よろしいですか？ | トラックをスケジュール全体の割当から外します。よろしいですか？ |
- **注記**: 「トラック」は非消耗品名を表す動的な値
- **優先度**: 高

### FR-012: 非消耗品削除確認モーダル（個別に解除）
- **説明**: 非消耗品を個別に外す際の確認モーダル
- **変更内容**: なし（現状維持）
- **優先度**: -

### FR-013: 手配表での割当選択肢（ドラッグ&ドロップ時）
- **説明**: 人員割当から予定カードにドラッグ&ドロップした際の選択肢テキストを変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | タイトル | アサイン先を選択してください。 | 割当方法を選択してください |
  | 選択肢1 | 個別の予定にのみアサイン | mm月dd日のみ |
  | 選択肢2 | 予定全体に一括アサイン | 全期間に一括 |
  | 選択肢3 | 期間指定して一括アサイン | 期間を指定して一括 |
  | 選択肢4 | 以降の予定に一括アサイン | mm月dd日以降に一括 |
- **適用範囲**: 手配表画面
- **優先度**: 高

### FR-014: 手配表での割当選択肢（＋ボタン押下時）
- **説明**: 予定カードから「＋」ボタンを押して変更する際の選択肢テキストを変更する
- **変更内容**:
  | 項目 | 現在のテキスト | 修正後のテキスト |
  |------|--------------|----------------|
  | タイトル | スケジュールの編集方法を選択してください | 割当方法を選択してください |
  | 選択肢1 | この予定のみ | mm月dd日のみ |
  | 選択肢2 | 予定全体 | 全期間に一括 |
  | 選択肢3 | 期間を指定 | 期間を指定して一括 |
  | 選択肢4 | これ以降 | mm月dd日以降に一括 |
- **適用範囲**: 手配表画面
- **優先度**: 高

## 非機能要件

### NFR-001: 対応プラットフォーム
- **説明**: SP（スマートフォン）とPCの両方で正しく表示される
- **基準**:
  - レスポンシブデザインにより、各プラットフォームで適切にテキストが表示される
  - 長いテキストでもレイアウトが崩れない
- **優先度**: 高

### NFR-002: 表示パフォーマンス
- **説明**: テキスト変更による表示パフォーマンスへの影響がない
- **基準**:
  - モーダル表示速度に変化がない
  - 日付の動的生成による遅延が発生しない
- **優先度**: 中

### NFR-003: 国際化対応（将来対応）
- **説明**: 将来的な多言語対応を考慮した実装とする
- **基準**:
  - ハードコーディングを避け、定数ファイルや翻訳ファイルで管理する
  - 日付フォーマットは locale を考慮できる実装とする
- **優先度**: 低

## 制約事項
- **実装範囲**: テキスト変更のみ（既存コンポーネントの修正）
- **変更対象外**: 案件詳細の3点リーダーをクリックした時の文言
  - **理由**: スケジュール表示UIが異なり、何を編集削除するのかが曖昧になるため
- **後方互換性**: 既存のAPI仕様やデータ構造には影響を与えない
- **リリース時期**: 次回リリース

## 画面仕様

### 対象画面
1. **ホワイトボード**: スケジュールモーダル
2. **カレンダー**: スケジュールモーダル
3. **手配表**: スケジュールモーダル、割当選択モーダル
4. **案件詳細**: スケジュールモーダル

### 選択肢モーダル

#### 基本構造
- **タイトル**: 操作の種類に応じたタイトル
- **選択肢リスト**: 4つの選択肢（ラジオボタンまたはリスト形式）
- **ボタン**: キャンセル、決定

#### 表示要素
- **日付**: 現在閲覧中のスケジュールの日付を「mm月dd日」形式で表示
- **名前**: 担当者名や非消耗品名（削除時）

### 確認モーダル

#### 基本構造
- **タイトル**: 確認メッセージ
- **本文**: 操作の影響範囲の説明
- **注釈**: 補足情報（該当する場合）
- **ボタン**: キャンセル、削除（または確定）

#### 削除ボタン
- **色**: 危険色（赤系）
- **位置**: 右側

## エラーハンドリング

| エラーケース | 条件 | ユーザーへの表示 |
|------------|------|-----------------|
| 日付取得失敗 | 現在閲覧中のスケジュールの日付が取得できない | フォールバック: 「この予定」などの代替表現 |
| 担当者名取得失敗 | 担当者名が空またはundefined | 「担当者」などの一般的な表現 |
| 非消耗品名取得失敗 | 非消耗品名が空またはundefined | 「割当」などの一般的な表現 |

## テスト観点

### 表示確認
- [ ] SP表示: 全ての選択肢テキストが正しく表示される
- [ ] PC表示: 全ての選択肢テキストが正しく表示される
- [ ] 日付フォーマット: 「mm月dd日」形式（先頭0なし、例: 1月1日）で表示される
- [ ] 長い担当者名・非消耗品名でもレイアウトが崩れない

### 画面別確認
- [ ] ホワイトボード: 編集・削除の選択肢テキストが正しい
- [ ] カレンダー: 編集・削除の選択肢テキストが正しい
- [ ] 手配表: 編集・削除・割当の選択肢テキストが正しい
- [ ] 案件詳細: 編集・削除の選択肢テキストが正しい

### 機能別確認
- [ ] 編集時: 4つの選択肢（全期間、mm月dd日のみ、期間指定、mm月dd日以降）が表示される
- [ ] スケジュール削除時: 4つの選択肢が表示される
- [ ] 担当者削除時: 2つの選択肢（全期間、mm月dd日）が表示される
- [ ] 非消耗品削除時: 2つの選択肢（全期間、mm月dd日）が表示される
- [ ] 手配表D&D時: 4つの選択肢（mm月dd日のみ、全期間に一括、期間指定、mm月dd日以降に一括）が表示される
- [ ] 手配表＋ボタン時: 4つの選択肢が表示される

### 確認モーダル確認
- [ ] 全体削除: タイトル「本当に削除しますか？」、本文が正しい
- [ ] 個別削除: 本文に「yyyy年mm月dd日」が含まれる
- [ ] 期間指定削除: 本文「削除すると復元できません。よろしいですか？」
- [ ] 以降削除: 本文「削除すると復元できません。よろしいですか？」
- [ ] 担当者全体解除: タイトル・本文が正しい
- [ ] 非消耗品全体解除: タイトル・本文が正しい

### 動的値確認
- [ ] 担当者名が正しく表示される（姓名の間にスペースあり）
- [ ] 非消耗品名が正しく表示される
- [ ] 現在閲覧中の日付が正しく反映される

### エッジケース
- [ ] 1月1日、12月31日などの境界日付が正しく表示される
- [ ] 年をまたぐ場合でも年は表示されない（個別削除の確認モーダルを除く）
- [ ] 担当者名・非消耗品名が長い場合でも表示が崩れない

### リグレッションテスト
- [ ] 変更対象外の案件詳細3点リーダーの文言が変更されていない
- [ ] 選択肢の機能（実際の編集・削除動作）に影響がない
- [ ] 既存のイベントハンドラが正常に動作する

## 備考

### 変更対象外について
案件詳細の3点リーダーをクリックした時の文言は変更対象外としています。これは、この画面ではスケジュール表示UIが異なり、何を編集・削除するのかが曖昧になるためです。統一性を保つには、UI全体の見直しが必要となるため、今回の対象外としています。

### 日付表示の一貫性
「mm月dd日のみ編集」などの表現では、日付が動的に変わります。実装時には、現在閲覧中のスケジュールの日付を正しく取得し、フォーマットする必要があります。

### 文言の短縮化
「繰り返しスケジュール」という冗長な表現を削減し、「全期間」「mm月dd日のみ」など、より簡潔で理解しやすい表現に変更しています。これにより、ユーザーの認知負荷を軽減します。

### 手配表の特殊性
手配表では「編集」ではなく「割当」という概念を使用しているため、選択肢のタイトルを「割当方法を選択してください」に統一しています。また、「一括」という表現を追加することで、複数日に対する操作であることを明示しています。

---
作成日: 2025-12-31
最終更新日: 2025-12-31
