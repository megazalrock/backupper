---
name: npm-release-check
description: npmリリース前の確認チェックリストを実行するスキル
---

# npm リリース前チェックリスト

npmパッケージをリリースする前に、以下のチェック項目を順番に実行し、結果を報告してください。

## チェック手順

以下の9項目を順に実行し、各項目の結果を `[PASS]` / `[FAIL]` / `[WARN]` で記録してください。

### 1. git 状態確認

`git status --porcelain` を実行し、コミットされていない変更がないか確認します。

- 出力が空 → `[PASS]`
- 出力がある → `[FAIL]` 未コミットの変更があります。変更内容を表示してください。

### 2. テスト実行

`bun run test` を実行し、全テストが合格するか確認します。

- 全テスト合格 → `[PASS]`
- 失敗あり → `[FAIL]` 失敗したテストを表示してください。

### 3. リント実行

`bun run lint` を実行し、リントエラーがないか確認します。

- エラーなし → `[PASS]`
- エラーあり → `[FAIL]` エラー内容を表示してください。

### 4. ビルド確認

`bun run build` を実行し、ビルドが成功するか確認します。

- 成功 → `[PASS]`
- 失敗 → `[FAIL]` エラー内容を表示してください。

### 5. package.json 必須フィールド確認

`package.json` を読み取り、以下のフィールドが存在し値が設定されているか確認します:

- `name`
- `version`
- `description`
- `license`
- `main`
- `bin`
- `files`
- `publishConfig`

すべて存在 → `[PASS]`
一部欠落 → `[FAIL]` 欠落しているフィールドを列挙してください。

### 6. バージョン確認

`npm view @megazalrock/backupper version` を実行し、現在の `package.json` の `version` と比較します。

- package.json のバージョンがレジストリより新しい → `[PASS]`
- 同じまたは古い → `[FAIL]` バージョンを更新してください。
- パッケージがレジストリに存在しない（初回リリース）→ `[PASS]` 初回リリースとして扱います。

### 7. パッケージ内容確認

`bun pm pack --dry-run` を実行し、パッケージに含まれるファイル一覧を表示します。

- ファイル一覧を表示し、不要なファイル（テストファイル、設定ファイル、`.env` 等）が含まれていないか確認 → 問題なければ `[PASS]`、疑わしいファイルがあれば `[WARN]` として一覧を表示してください。

### 8. README.md / LICENSE.md 存在確認

プロジェクトルートに `README.md` と `LICENSE.md`（または `LICENSE`）が存在するか確認します。

- 両方存在 → `[PASS]`
- いずれか欠落 → `[WARN]` 欠落しているファイルを表示してください。

### 9. git タグ重複確認

`git tag -l "v{version}"` を実行し（`{version}` は package.json の version）、同名のタグが既に存在しないか確認します。

- タグが存在しない → `[PASS]`
- タグが既に存在する → `[FAIL]` バージョンを更新するか、タグを削除してください。

## 結果サマリー

すべてのチェック完了後、以下の形式でサマリーを出力してください:

```
## リリースチェック結果サマリー

| # | チェック項目                | 結果   |
|---|---------------------------|--------|
| 1 | git 状態確認               | [PASS] |
| 2 | テスト実行                 | [PASS] |
| ...                                     |

✅ リリース準備完了です！
```

- すべて `[PASS]` または `[WARN]` のみ → 「リリース準備完了」
- `[FAIL]` が1つ以上 → 「修正が必要な項目があります」として失敗項目を列挙
